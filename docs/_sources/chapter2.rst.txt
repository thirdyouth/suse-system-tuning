*************************************************************
系统监测工具
*************************************************************

.. topic:: 摘要

   有许多程序，工具可用于检查你的系统状态。本章主要介绍一些此类工具，并且讲述它们最重要，以及经常使用的参数。

对于每个讲解的指令，将会展示相关输出示例。如下示例中，第一行是命令（在 `tux >` 或者 根符号 `#` 之后）。省略内容会使用中括号表示（`[...]`），超长内容有必要的将会换行处理。对于长的行，行中断将会通过斜线表示（`\\`）。

.. code-block:: shell

   tmux > command -x -y
   output line 1
   output line 2
   output line 3 is annoyingly long, so long that \
       we need to break it
   output line 4
   [...]
   output line 98
   output line 99

这些讲解将尽可能的简短，这样我们可以包含尽可能多的工具。更多有关这些指令的详细信息可以查看操作手册页。大多数的指令都可以接受参数 :option:`--help`，它将会打印出可接受参数的简要列表。

多功能工具
=============================================================

尽管多数 Linux 系统下的监测工具仅检测系统中的一个单独部分，仍然有一些工具适用于更多的领域。如果为了了解系统概况，然后找出后续跟进检查的部分，可以首先使用以下的工具。

vmstat
-------------------------------------------------------------

vmstat 收集有关进程，内存，I/O，中断以及CPU的信息。如果启动时不附带采样频率，它将会显示最近启动以后的平均数值。如果使用了采样频率，它将会显示实际的采样信息：

**示例2.1** ： vmstat 在轻量使用机器上的输出

.. code-block:: shell

   tux > vmstat 2
   procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
   r b swpd free cache si so bi bo in cs us sy id wa st
   1 0 44264 81520
   buff
   424 935736 0 0 12 25 27 34 1 0 98 0 0
   0 0 44264 81552 424 935736 0 0 0 0 38 25 0 0 100 0 0
   0 0 44264 81520 424 935732 0 0 0 0 23 15 0 0 100 0 0
   0 0 44264 81520 424 935732 0 0 0 0 36 24 0 0 100 0 0
   0 0 44264 81552 424 935732 0 0 0 0 51 38 0 0 100 0 0

系统活动信息：sar 和 sadc
-------------------------------------------------------------

使用 sadc 自动整理日常统计信息
*************************************************************


使用 sar 生成日志报表
*************************************************************

CPU 使用报表：sar
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


内存使用报表：sar -r
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

分页统计报表：sar -B
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

块设备统计报表：sar -d
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

网络统计报表：sar -n KEYWORD
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


sar 数据可视化
*************************************************************


系统信息
=============================================================

设备加载信息：iostat
-------------------------------------------------------------

进程活动监测：mpstat
-------------------------------------------------------------

任务监测：pidstat
-------------------------------------------------------------

内核循环Buffer：dmesg
-------------------------------------------------------------

打开文件列表：lsof
-------------------------------------------------------------

内核和udev事件队列查看：udevadm monitor
-------------------------------------------------------------


安全事件信息：audit
-------------------------------------------------------------

X11客户端所用服务器资源：xrestop
-------------------------------------------------------------

进程
=============================================================

进程间通讯：ipcs
-------------------------------------------------------------

进程列表：ps
-------------------------------------------------------------

进程树：pstree
-------------------------------------------------------------

进程表：top
-------------------------------------------------------------

类似于 top 的 I/O 监测：iotop
-------------------------------------------------------------

进程资源微调：nice 和 renice
-------------------------------------------------------------


内存
=============================================================

内存使用状态：free
-------------------------------------------------------------

详细内存使用状态：/proc/meminfo
-------------------------------------------------------------


进程内存使用状态：smaps
-------------------------------------------------------------


网络
=============================================================

显示网络状态：netstat
------------------------------------------------------------

交互网络监测：iptraf
------------------------------------------------------------

/proc 文件系统
=============================================================

procinfo
------------------------------------------------------------

硬件信息
=============================================================

PCI 资源：lspci
------------------------------------------------------------

USB 设备：lsusb
------------------------------------------------------------

文件和文件系统
=============================================================

查看文件类型：file
------------------------------------------------------------

文件系统和用法：mount, df 和 du
------------------------------------------------------------
